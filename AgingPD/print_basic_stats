def print_basic_stats(self):
        """ê¸°ë³¸ í†µê³„ ì¶œë ¥"""
        total_detections = 0
        emotion_counts = defaultdict(int)

        for frame_stat in self.frame_stats:
            for person in frame_stat['persons']:
                for face in person['faces']:
                    total_detections += 1
                    emotion_counts[face['emotion']] += 1

        print(f"ğŸ“Š ê¸°ë³¸ í†µê³„:")
        print(f"   ì´ íƒì§€ ìˆ˜: {total_detections}")
        if emotion_counts:
            print(f"   ê°ì •ë³„ ë¶„í¬:")
            for emotion, count in emotion_counts.items():
                percentage = (count / total_detections) * 100 if total_detections > 0 else 0
                print(f"     {emotion}: {count}íšŒ ({percentage:.1f}%)")

    def save_analysis_results(self, input_path, output_path):
        """ë¶„ì„ ê²°ê³¼ ì €ì¥"""
        base_name = os.path.splitext(os.path.basename(input_path))[0]
        timestamp = int(time.time())

        # JSON ì§ë ¬í™”ë¥¼ ìœ„í•œ ë°ì´í„° ë³€í™˜
        serializable_stats = self.convert_to_serializable(self.frame_stats)

        # JSON ìƒì„¸ ê²°ê³¼
        json_path = f"emotion_analysis_{base_name}_{timestamp}.json"
        with open(json_path, 'w', encoding='utf-8') as f:
            json.dump(serializable_stats, f, indent=2, ensure_ascii=False)
        print(f"ğŸ“„ ìƒì„¸ ê²°ê³¼ ì €ì¥: {json_path}")

        # CSV ìš”ì•½ í†µê³„
        csv_path = f"emotion_summary_{base_name}_{timestamp}.csv"
        self.create_summary_csv(csv_path)
        print(f"ğŸ“Š ìš”ì•½ í†µê³„ ì €ì¥: {csv_path}")

        # ì‹œê°í™” ì°¨íŠ¸
        chart_path = f"emotion_chart_{base_name}_{timestamp}.png"
        self.create_emotion_chart(chart_path)
        print(f"ğŸ“ˆ ê°ì • ì°¨íŠ¸ ì €ì¥: {chart_path}")

    def convert_to_serializable(self, data):
        """NumPy íƒ€ì…ì„ JSON ì§ë ¬í™” ê°€ëŠ¥í•œ íƒ€ì…ìœ¼ë¡œ ë³€í™˜"""
        if isinstance(data, dict):
            return {key: self.convert_to_serializable(value) for key, value in data.items()}
        elif isinstance(data, list):
            return [self.convert_to_serializable(item) for item in data]
        elif isinstance(data, np.integer):
            return int(data)
        elif isinstance(data, np.floating):
            return float(data)
        elif isinstance(data, np.ndarray):
            return data.tolist()
        else:
            return data

    def create_summary_csv(self, csv_path):
        """ìš”ì•½ í†µê³„ CSV ìƒì„±"""
        summary_data = []

        for frame_stat in self.frame_stats:
            for person in frame_stat['persons']:
                for face in person['faces']:
                    summary_data.append({
                        'frame_number': int(frame_stat['frame_number']),
                        'person_id': int(person['person_id']),
                        'emotion': str(face['emotion']),
                        'confidence': float(face['confidence']),
                        'yolo_confidence': float(person['yolo_confidence'])
                    })

        if summary_data:  # ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°ë§Œ ì €ì¥
            df = pd.DataFrame(summary_data)
            df.to_csv(csv_path, index=False, encoding='utf-8')
        else:
            # ë¹ˆ CSV íŒŒì¼ ìƒì„±
            df = pd.DataFrame(columns=['frame_number', 'person_id', 'emotion', 'confidence', 'yolo_confidence'])
            df.to_csv(csv_path, index=False, encoding='utf-8')
            print("âš ï¸ ê°ì • ë°ì´í„°ê°€ ì—†ì–´ ë¹ˆ CSV íŒŒì¼ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.")
